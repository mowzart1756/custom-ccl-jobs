SELECT
	E.ENCNTR_ID
	, D.PCT_CARE_TEAM_ID
	, P_PCT_MED_SERVICE_DISP = UAR_GET_CODE_DISPLAY(P.PCT_MED_SERVICE_CD) ; Dispaly this
	, P_PCT_TEAM_DISP = UAR_GET_CODE_DISPLAY(P.PCT_TEAM_CD) ; Display this as the smaller team
	, E.UPDT_ID
	, D.UPDT_ID
	, P.UPDT_ID
	, D.BEG_EFFECTIVE_DT_TM

FROM
	ENCOUNTER   E
	, (LEFT JOIN DCP_SHIFT_ASSIGNMENT D ON (E.ENCNTR_ID = D.ENCNTR_ID))
	, (LEFT JOIN PCT_CARE_TEAM P ON (P.PCT_CARE_TEAM_ID = D.PCT_CARE_TEAM_ID))

PLAN E
	WHERE
	E.ENCNTR_ID = 48473078 ; Input your encounter id

JOIN D
	;WHERE 


JOIN P
	WHERE
	E.LOC_FACILITY_CD = P.FACILITY_CD

ORDER BY
	D.BEG_EFFECTIVE_DT_TM

WITH MAXREC = 100, NOCOUNTER, SEPARATOR=" ", FORMAT, TIME = 5

/* Option 2

Trying to use less tables

*/

SELECT
	D.PCT_CARE_TEAM_ID
	, P_PCT_MED_SERVICE_DISP = UAR_GET_CODE_DISPLAY(P.PCT_MED_SERVICE_CD) ; Dispaly this
	, P_PCT_TEAM_DISP = UAR_GET_CODE_DISPLAY(P.PCT_TEAM_CD) ; Display this as the smaller team
	, D.BEG_EFFECTIVE_DT_TM
	, D.END_EFFECTIVE_DT_TM

FROM
	DCP_SHIFT_ASSIGNMENT   D
	, (LEFT JOIN PCT_CARE_TEAM P ON (P.PCT_CARE_TEAM_ID = D.PCT_CARE_TEAM_ID))

PLAN D
	WHERE
	D.ENCNTR_ID = 48473078 ; Input your encounter id
	AND
	D.BEG_EFFECTIVE_DT_TM < CNVTDATETIME(CURDATE, curtime3)
	AND
	D.END_EFFECTIVE_DT_TM > CNVTDATETIME(CURDATE, curtime3)
	

JOIN P

WITH MAXREC = 100, NOCOUNTER, SEPARATOR=" ", FORMAT, TIME = 5
SELECT DISTINCT
/*
NOTES:
Retrieves Codes that are incorrectly mapped.
 */
     PBS_CODE = P_P.PBS_ITEM_CODE
    , P_L.DRUG_TYPE_MEAN
    , PRESCRIBER_TYPE = UAR_GET_CODE_DISPLAY(P_P.PRESCRIBER_TYPE_CD)

FROM
    PBS_OCS_MAPPING             P_O_M
    , PBS_LISTING               P_L
    , PBS_ITEM                  P_I
    , PBS_DRUG                  P_D
    , PBS_PRESCRIBER            P_P_1
    , PBS_PRESCRIBER            P_P_2


/*Filter for mapped items only */
PLAN P_O_M /* PBS_OCS_MAPPING */ ;P_O_M.PBS_DRUG_ID
    /* Remove Dummy Rows */
    WHERE P_O_M.PBS_DRUG_ID != 11111111.00

JOIN P_D ; PBS_DRUG ; P_D.PBS_DRUG_ID P_D.PBS_ITEM_ID
    WHERE P_D.PBS_ITEM_ID = P_I.PBS_ITEM_ID

JOIN P_I ; PBS_ITEM ; P_I.PBS_ITEM_ID P_I.PBS_LISTING_ID
     WHERE P_I.PBS_LISTING_ID = P_D.PBS_ITEM_ID

/* Items that should not be mapped */
JOIN P_L ; PBS_LISTING  ; P_L.PBS_LISTING_ID   P_L.PBS_ITEM_CODE
        WHERE P_L.PBS_LISTING_ID = P_I.PBS_LISTING_ID

JOIN P_P_1 /* PBS_PRESCRIBER */ ; PBS_ITEM_CODE
    WHERE P_P_1.PBS_ITEM_CODE = P_L.PBS_ITEM_CODE
    AND P_P_1.PRESCRIBER_TYPE_CD NOT IN
    (
        86244504.00	;Medical Practitioner
        , 86244510.00	;Nurse Practitioner
        , 86244507.00	;Midwife
    )

; /*Filter for mapped items only */


; ORDER BY
;     P_L.PBS_ITEM_CODE
;     , 0

WITH	TIME = 60
